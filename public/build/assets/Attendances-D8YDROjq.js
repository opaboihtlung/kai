import{Q as _}from"./QChip-BKFdpbUD.js";import{Q as U}from"./QSelect-DAcR8xz5.js";import{r as j,A as E,o as u,c as m,w as n,g as s,a as o,i as g,d as x,n as b,h as w,Q as N,e as D,f as S,F as A,C as O,O as V,t as C,u as z,p as R}from"./app-CD2aFJMz.js";import{Q as Y}from"./QDate-DQAHrZCw.js";import{Q as G}from"./QPopupProxy-DVOTFfbx.js";import{_ as H,Q as q,c as v,d as J,a as M,b as B}from"./MainLayout-BhDzJCbe.js";import{Q as K}from"./QLayout-BZLnjnEC.js";import{C as h}from"./ClosePopup-BBeWmOkr.js";import{d as $}from"./date-BNbFJ6l6.js";import{u as W}from"./utils-f6ewzwJT.js";import{_ as X}from"./Geolocation-DxeyX3jL.js";import"./rtl-DFPa-2ov.js";import"./use-cache-hsIl6Ivw.js";import"./selection-BtuRkBgR.js";import"./FooterComponent-yubzXBYP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-quasar-B6weMyZ6.js";import"./index.es-Dvo41eUP.js";const Z={class:"flex justify-between items-center"},ee=s("div",null,[s("div",{class:"text-title"},"Log Book")],-1),te={class:"flex q-gutter-sm items-center"},le={class:"row items-center justify-end"},oe=s("br",null,null,-1),ae={class:"flex q-gutter-sm items-center"},ne={class:"text-center"},re={class:"flex items-center q-gutter-sm"},se={class:"flex q-gutter-sm"},Ve=Object.assign({layout:H},{__name:"Attendances",props:["list","users","user","present","late","from","to"],setup(p){var k,Q;const i=p,{formatDateTime:F}=W(),e=j({filter:{present:!!i.present,late:!!i.late,user:{value:(k=i.user)==null?void 0:k.id,label:(Q=i==null?void 0:i.user)==null?void 0:Q.full_name},rangeText:"From: "+i.from+" to:"+i.to,dateRange:{from:i.from||$.formatDate(Date.now(),"Y/MM/DD"),to:i.to||$.formatDate(Date.now(),"Y/MM/DD")}},openMap:!1,selected:null});E(()=>{var l,d;const r=(l=e.filter.dateRange)==null?void 0:l.from,t=(d=e.filter.dateRange)==null?void 0:d.to;return r&&t?"From: "+r+" to:"+t:"NA"});const y=(r,t)=>{e.selected=r,t==="detail"&&V.get(route("attendance.show",r.id)),t==="map"&&(e.openMap=!0)},I=r=>{var t,l;e.filter.rangeText=""+((t=r.from)==null?void 0:t.year)+"/"+r.from.month+"/"+r.from.day+"-"+((l=r.to)==null?void 0:l.year)+"/"+r.to.month+"/"+r.to.day},L=r=>{var c;const t=e.filter.dateRange.from,l=e.filter.dateRange.to,d=e.filter.present,a=e.filter.late;V.get(route("office.attendances"),{user_id:(c=e.filter.user)==null?void 0:c.value,from:t,to:l,present:d,late:a})},P=r=>{var c;const t=e.filter.dateRange.from,l=e.filter.dateRange.to,d=e.filter.present,a=e.filter.late;axios.get(route("office.attendances.download"),{params:{user_id:(c=e.filter.user)==null?void 0:c.value,from:t,to:l,present:d,late:a}}).then(f=>{const{link:T}=f.data;window.open(T,"_blank")}).catch(f=>console.log(f))};return(r,t)=>(u(),m(K,{class:"container",padding:""},{default:n(()=>[s("div",Z,[ee,s("div",te,[o(_,{outline:!e.filter.present,selected:e.filter.present,"onUpdate:selected":t[0]||(t[0]=l=>e.filter.present=l),color:"primary","text-color":"white"},{default:n(()=>[g(" Present ")]),_:1},8,["outline","selected"]),o(_,{outline:!e.filter.late,selected:e.filter.late,"onUpdate:selected":t[1]||(t[1]=l=>e.filter.late=l),color:"warning","text-color":"white"},{default:n(()=>[g(" Late ")]),_:1},8,["outline","selected"]),o(U,{placeholder:"Select Employee",modelValue:e.filter.user,"onUpdate:modelValue":t[2]||(t[2]=l=>e.filter.user=l),options:p.users,style:{"min-width":"220px"},outlined:"",dense:"",rounded:"","bg-color":"white"},null,8,["modelValue","options"]),o(N,{"hide-bottom-space":"",placeholder:"Date of attendance",outlined:"","bg-color":"white",rounded:"",dense:"",modelValue:e.filter.rangeText,"onUpdate:modelValue":t[4]||(t[4]=l=>e.filter.rangeText=l)},{append:n(()=>[o(x,{name:"event",class:"cursor-pointer"},{default:n(()=>[o(G,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[o(Y,{onRangeEnd:I,range:"",modelValue:e.filter.dateRange,"onUpdate:modelValue":t[3]||(t[3]=l=>e.filter.dateRange=l)},{default:n(()=>[s("div",le,[b(o(w,{label:"Close",color:"primary",flat:""},null,512),[[h]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(w,{onClick:L,rounded:"",label:"Filter",color:"primary"}),o(w,{onClick:P,color:"primary",outline:"",rounded:"",icon:"download","no-caps":""})])]),oe,o(q,null,{default:n(()=>{var l,d;return[(u(!0),D(A,null,S(p.list.data,a=>{var c;return u(),D("div",{class:"q-mt-sm shadow-default bg-white q-pa-sm flex justify-between items-center",key:a.id},[s("div",ae,[a.type==="present"?(u(),m(x,{key:0,size:"24px",name:"fiber_manual_record",color:"positive"})):(u(),m(x,{key:1,size:"24px",name:"fiber_manual_record",color:"warning"})),s("div",null,[o(v,null,{default:n(()=>{var f;return[g(C((f=a==null?void 0:a.user)==null?void 0:f.full_name),1)]}),_:2},1024),o(v,{caption:""},{default:n(()=>[g(C(z(F)(a==null?void 0:a.signin_at)),1)]),_:2},1024)])]),s("div",ne,[o(_,{"text-color":"white",square:"",color:"secondary",label:(c=a==null?void 0:a.device)==null?void 0:c.name},null,8,["label"])]),s("div",null,[s("div",re,[a.type==="present"?(u(),m(_,{key:0,class:"text-white",square:"",color:"positive",label:"Present"})):(u(),m(_,{key:1,class:"text-white",square:"",color:"warning",label:"Late"})),o(J,{class:"q-pa-xs","dropdown-icon":"more_vert"},{default:n(()=>[o(q,null,{default:n(()=>[b((u(),m(M,{clickable:"",onClick:R(f=>y(a,"detail"),["stop"])},{default:n(()=>[o(B,null,{default:n(()=>[o(v,null,{default:n(()=>[g("Detail")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[h]]),b((u(),m(M,{clickable:"",onClick:R(f=>y(a,"map"),["stop"])},{default:n(()=>[o(B,null,{default:n(()=>[o(v,null,{default:n(()=>[g("View Geolocation")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[h]])]),_:2},1024)]),_:2},1024)])])])}),128)),s("div",se,[o(w,{onClick:t[5]||(t[5]=a=>r.$inertia.get(p.list.prev_page_url)),disable:!((l=p.list)!=null&&l.prev_page_url),round:"",flat:"",icon:"o_chevron_left"},null,8,["disable"]),o(w,{onClick:t[6]||(t[6]=a=>r.$inertia.get(p.list.next_page_url)),disable:!((d=p.list)!=null&&d.next_page_url),round:"",flat:"",icon:"o_chevron_right"},null,8,["disable"])])]}),_:1}),o(O,{modelValue:e.openMap,"onUpdate:modelValue":t[7]||(t[7]=l=>e.openMap=l)},{default:n(()=>[o(X,{attendance:e.selected},null,8,["attendance"])]),_:1},8,["modelValue"])]),_:1}))}});export{Ve as default};
