import{r as W,A as X,o as s,c as i,w as n,g as d,a as o,Q as j,h as c,i as m,e as f,f as E,F as N,k as Z,C as P,v as ee,n as _,ad as h,O as g,d as q,m as k,t as Y,p as w}from"./app-CD2aFJMz.js";import{Q as p}from"./QChip-BKFdpbUD.js";import{_ as le,Q as z,c as y,d as te,a as Q,b as C}from"./MainLayout-BhDzJCbe.js";import{Q as ae}from"./QSelect-DAcR8xz5.js";import{Q as oe}from"./QLayout-BZLnjnEC.js";import{C as v}from"./ClosePopup-BBeWmOkr.js";import{u as se}from"./use-quasar-B6weMyZ6.js";import{d as T}from"./date-BNbFJ6l6.js";import{_ as ne}from"./Geolocation-DxeyX3jL.js";import"./selection-BtuRkBgR.js";import"./FooterComponent-yubzXBYP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./rtl-DFPa-2ov.js";import"./index.es-Dvo41eUP.js";import"./utils-f6ewzwJT.js";const de={class:"flex justify-between items-center"},re=d("div",null,[d("div",{class:"text-title"},"Log Books")],-1),ie={class:"flex q-gutter-sm items-center"},ue={class:"flex justify-between items-center q-my-md"},ce={class:"text-grey-7 text-weight-medium q-ma-none"},fe={class:"flex q-gutter-sm items-center"},pe={key:0},me={key:1},_e={class:"flex items-center q-gutter-sm"},ge={key:0,class:"text-right"},ve={class:"text-lg text-time"},be={key:1},xe={class:"flex q-gutter-sm"},he={class:"flex justify-between items-center"},ke=d("div",{class:"text-lg text-weight-medium"},"Filter",-1),ye={class:"column q-mt-sm"},Ve={class:"flex items-center q-gutter-sm q-pa-sm"},je=Object.assign({layout:le},{__name:"AttendanceList",props:["list","filter","users","date","search","selectedOffices","offices"],setup(u){const D=se(),b=u,a=W({search:b.search,date:b.date,openMap:!1,openFilter:!1,selected:null,filter:b.filter||"all",offices:b.selectedOffices}),H=r=>T.formatDate(r,"HH:mm a"),G=X(()=>T.formatDate(a.date,"DD/MM/YYYY")),R=r=>{var l;D.loading.show(),axios.get(route("office.attendance-list.export"),{params:{office_ids:(l=a.offices)==null?void 0:l.map(t=>t.value),...a}}).then(t=>{const{link:x}=t.data;window.open(x,"_blank")}).catch(t=>{console.log(t)}).finally(()=>D.loading.hide())},V=(r,l)=>{a.selected=r,l==="log"&&g.get(route("user.attendances",r.id)),l==="detail"&&g.get(route("attendance.show",r.id)),l==="map"&&(a.openMap=!0)},J=r=>{var l;g.get(route("office.attendance-list"),{office_ids:(l=a.offices)==null?void 0:l.map(t=>t.value),...a})},K=r=>{var l;a.openFilter=!1,g.get(route("office.attendance-list"),{office_ids:(l=a.offices)==null?void 0:l.map(t=>t.value),...a})},F=r=>g.get(r,{...a});return(r,l)=>(s(),i(oe,{class:"container",padding:""},{default:n(()=>[d("div",de,[re,d("div",ie,[o(j,{modelValue:a.search,"onUpdate:modelValue":[l[0]||(l[0]=t=>a.search=t),J],autofocus:"",outlined:"","bg-color":"white",rounded:"",dense:"",debounce:800,placeholder:"Type name..."},null,8,["modelValue"]),o(c,{color:"primary",round:"",onClick:l[1]||(l[1]=t=>a.openFilter=!0),icon:"sort"})])]),d("div",ue,[d("p",ce,[m(" Attendances for the dates of "),o(p,{square:"",label:G.value},null,8,["label"]),m(" Filter :"),o(p,{square:"",label:a.filter},null,8,["label"]),(s(!0),f(N,null,E(a.offices,t=>(s(),i(p,{square:"",key:t.id,label:t.label},null,8,["label"]))),128))]),o(c,{outline:"",color:"primary",onClick:R,label:"Export Excel","no-caps":""})]),o(Z,{spaced:""}),o(z,null,{default:n(()=>{var t,x;return[(s(!0),f(N,null,E(u.list.data,e=>{var B,U,A,L,M,$,I,O;return s(),f("div",{class:"q-mt-sm shadow-default bg-white q-pa-sm flex justify-between items-center",key:e.id},[d("div",fe,[((B=e.attendances)==null?void 0:B.length)>0?(s(),f("div",pe,[((U=e==null?void 0:e.attendances[0])==null?void 0:U.type)==="present"?(s(),i(q,{key:0,size:"21px",name:"fiber_manual_record",color:"positive"})):((A=e==null?void 0:e.attendances[0])==null?void 0:A.type)!=="present"?(s(),i(q,{key:1,size:"21px",name:"fiber_manual_record",color:"warning"})):k("",!0)])):(s(),f("div",me,[o(q,{size:"21px",name:"fiber_manual_record",color:"negative"})])),d("div",null,[o(y,null,{default:n(()=>[m(Y(e==null?void 0:e.full_name),1)]),_:2},1024),((L=e.attendances)==null?void 0:L.length)>0?(s(),i(p,{key:0,class:"text-caption q-ml-none",square:"",label:($=(M=e==null?void 0:e.attendances[0])==null?void 0:M.office)==null?void 0:$.name},null,8,["label"])):k("",!0)])]),d("div",null,[d("div",_e,[((I=e.attendances)==null?void 0:I.length)>0?(s(),f("div",ge,[d("div",ve,Y((e==null?void 0:e.attendances.length)>0?H((O=e==null?void 0:e.attendances[0])==null?void 0:O.signin_at):"Absent"),1),(e==null?void 0:e.attendances[0].type)==="present"?(s(),i(p,{key:0,class:"q-ma-none text-white text-caption",square:"",color:"positive",label:"Present"})):(s(),i(p,{key:1,class:"q-ma-none text-white text-caption",square:"",color:"warning",label:"Late"}))])):(s(),f("div",be,[o(p,{class:"text-white text-caption",square:"",color:"negative",label:"Absent"})])),o(te,{class:"q-pa-xs","dropdown-icon":"more_vert"},{default:n(()=>[o(z,null,{default:n(()=>[_((s(),i(Q,{clickable:"",onClick:w(S=>V(e,"log"),["stop"])},{default:n(()=>[o(C,null,{default:n(()=>[o(y,null,{default:n(()=>[m("Log")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[v]]),(e==null?void 0:e.attendances.length)>0?_((s(),i(Q,{key:0,clickable:"",onClick:w(S=>V(e==null?void 0:e.attendances[0],"detail"),["stop"])},{default:n(()=>[o(C,null,{default:n(()=>[o(y,null,{default:n(()=>[m("Detail")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[v]]):k("",!0),(e==null?void 0:e.attendances.length)>0?_((s(),i(Q,{key:1,clickable:"",onClick:w(S=>V(e==null?void 0:e.attendances[0],"map"),["stop"])},{default:n(()=>[o(C,null,{default:n(()=>[o(y,null,{default:n(()=>[m("View Geolocation")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[v]]):k("",!0)]),_:2},1024)]),_:2},1024)])])])}),128)),d("div",xe,[o(c,{color:"primary",onClick:l[2]||(l[2]=e=>F(u.list.prev_page_url)),disable:!((t=u.list)!=null&&t.prev_page_url),round:"",flat:"",icon:"o_chevron_left"},null,8,["disable"]),o(c,{color:"primary",onClick:l[3]||(l[3]=e=>F(u.list.next_page_url)),disable:!((x=u.list)!=null&&x.next_page_url),round:"",flat:"",icon:"o_chevron_right"},null,8,["disable"])])]}),_:1}),o(P,{modelValue:a.openMap,"onUpdate:modelValue":l[4]||(l[4]=t=>a.openMap=t)},{default:n(()=>[o(ne,{attendance:a.selected},null,8,["attendance"])]),_:1},8,["modelValue"]),o(P,{modelValue:a.openFilter,"onUpdate:modelValue":l[11]||(l[11]=t=>a.openFilter=t)},{default:n(()=>[o(ee,{style:{width:"340px"},class:"q-pa-sm"},{default:n(()=>[d("div",he,[ke,_(o(c,{class:"q-pa-xs",round:"",icon:"close"},null,512),[[v]])]),o(ae,{modelValue:a.offices,"onUpdate:modelValue":l[5]||(l[5]=t=>a.offices=t),options:u.offices,outlined:"","use-chips":"",multiple:"",label:"Office"},null,8,["modelValue","options"]),o(j,{modelValue:a.date,"onUpdate:modelValue":l[6]||(l[6]=t=>a.date=t),class:"q-mt-sm",type:"date",outlined:"",label:"Date"},null,8,["modelValue"]),d("div",ye,[o(h,{modelValue:a.filter,"onUpdate:modelValue":l[7]||(l[7]=t=>a.filter=t),val:"present",label:"Present"},null,8,["modelValue"]),o(h,{modelValue:a.filter,"onUpdate:modelValue":l[8]||(l[8]=t=>a.filter=t),val:"late",label:"Late"},null,8,["modelValue"]),o(h,{modelValue:a.filter,"onUpdate:modelValue":l[9]||(l[9]=t=>a.filter=t),val:"absent",label:"Absent"},null,8,["modelValue"]),o(h,{modelValue:a.filter,"onUpdate:modelValue":l[10]||(l[10]=t=>a.filter=t),val:"all",label:"All"},null,8,["modelValue"])]),d("div",Ve,[o(c,{onClick:K,color:"primary",label:"Apply"}),_(o(c,{color:"negative",outline:"",label:"Close"},null,512),[[v]])])]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{je as default};
