import{r as ee,j as oe,T as te,o as m,c as g,w as u,g as r,h as p,a,k as se,Q as _,u as s,e as le,f as ae,F as re,O as k,d as Y,i as j,t as A,l as ie}from"./app-CD2aFJMz.js";import{Q as z}from"./QSelect-DAcR8xz5.js";import{_ as ne,Q as de,a as ce,b as y,c as P}from"./MainLayout-BhDzJCbe.js";import{Q as ue}from"./QForm-BBfP4Z3U.js";import{Q as me}from"./QLayout-BZLnjnEC.js";import{u as fe}from"./use-quasar-B6weMyZ6.js";import"./QChip-BKFdpbUD.js";import"./rtl-DFPa-2ov.js";import"./selection-BtuRkBgR.js";import"./FooterComponent-yubzXBYP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ge={class:"flex justify-between items-center"},pe=r("div",null,[r("div",{class:"text-title"},"Edit User")],-1),ve={class:"flex q-gutter-sm"},be={class:"col-xs-12 col-sm-7"},_e={class:"row q-col-gutter-sm q-pa-md bg-white"},we=r("legend",{class:"q-pa-sm text-white bg-dark text-lg rounded-borders text-md"},"Account Information",-1),he={class:"col-xs-12"},ke={class:"col-xs-12"},ye={class:"col-xs-12"},Ve={class:"col-xs-12"},xe={class:"col-xs-12"},Se={class:"col-xs-12"},Qe={class:"col-xs-12"},Ce={class:"flex q-gutter-sm"},De={class:"col-xs-12 col-sm-5"},qe={class:"bg-white q-pa-md"},Oe=r("legend",{class:"q-pa-sm text-white bg-dark text-lg rounded-borders text-md"},"Devices",-1),je=Object.assign({layout:ne},{__name:"Edit",props:["roles","offices","data","current_offices","role"],setup(b){var x,S,Q,C;const d=b;console.log(d.offices);const f=ee({submitting:!1,toggle:"password"}),w=oe(d.offices||[]),R=(l,e)=>{if(l.length>0){const i=(t.value.offices||[]).slice();l.split(/[,;|]+/).map(n=>n.trim()).filter(n=>n.length>0).forEach(n=>{d.offices.some(v=>v.name===n)||d.offices.push({name:n}),i.includes(n)===!1&&i.push(n)}),e(null),t.value.offices=i}},G=(l,e)=>{e(()=>{if(l==="")w.value=d.offices;else{const i=l.toLowerCase();w.value=d.offices.filter(n=>n.label.toLowerCase().includes(i))}})},c=fe(),t=te({full_name:(x=d.data)==null?void 0:x.full_name,designation:(S=d.data)==null?void 0:S.designation,mobile:(Q=d.data)==null?void 0:Q.mobile,password:"",role:(C=d==null?void 0:d.role)==null?void 0:C.name,offices:d.current_offices}),H=l=>{c.dialog({title:"Confirmation",message:"Do you want to delete it?",ok:"Yes",cancel:"No"}).onOk(()=>{k.delete(route("user.destroy",d.data.id),{preserveState:!1,onStart:e=>c.loading.show({message:"Deleting..."}),onFinish:e=>c.loading.hide()})})},J=l=>{c.loading.show(),axios.put(route("device.toggle",l.id)).then(e=>{const{message:i}=e.data;c.notify({message:i,type:"positive"})}).finally(()=>c.loading.hide())},K=l=>{c.dialog({title:"Confirmation",message:"Do you want to Deactivate it?",ok:"Yes",cancel:"No"}).onOk(()=>{k.put(route("user.deactivate",d.data.id),{preserveState:!1,onStart:e=>c.loading.show({message:"Deactivating..."}),onFinish:e=>c.loading.hide()})})},W=l=>{c.dialog({title:"Confirmation",message:"Do you want to activate this account?",ok:"Yes",cancel:!0}).onOk(()=>{k.put(route("user.activate",l.id),{},{preserveState:!1})})},V=l=>f.toggle=f.toggle==="password"?"text":"password",X=l=>{var e;t.transform(i=>{var n;return{office_ids:(n=i==null?void 0:i.offices)==null?void 0:n.map(v=>v.value),...i}}).put(route("user.update",(e=d.data)==null?void 0:e.id),{onStart:i=>c.loading.show({message:"Updating..."}),onFinish:i=>c.loading.hide()})},Z=l=>{c.dialog({title:"Confirmation",message:"Do you want to delete this device?",ok:"Yes",cancel:"No"}).onOk(()=>{c.loading.show(),axios.delete(route("device.destroy",l.id)).then(e=>{sessionStorage.setItem("deleteMessage",e.data.message),window.location.reload()}).catch(e=>{console.error(e)})})};return window.addEventListener("load",()=>{const l=sessionStorage.getItem("deleteMessage");l&&(c.notify({type:"positive",message:l}),sessionStorage.removeItem("deleteMessage"))}),(l,e)=>(m(),g(me,{class:"container",padding:""},{default:u(()=>{var i;return[r("div",ge,[pe,r("div",ve,[(i=b.data)!=null&&i.deleted_at?(m(),g(p,{key:0,loading:f.submitting,onClick:e[0]||(e[0]=n=>W(b.data)),color:"positive",outline:"",label:"Activate"},null,8,["loading"])):(m(),g(p,{key:1,loading:f.submitting,onClick:K,color:"negative",outline:"",label:"Deactivate"},null,8,["loading"])),a(p,{loading:f.submitting,onClick:H,color:"negative",label:"Delete"},null,8,["loading"])])]),a(se,{class:"q-my-md"}),a(ue,{class:"row q-col-gutter-sm",onSubmit:X,autocomplete:"off"},{default:u(()=>{var n,v,D,q,O,U,F,I,N,L,$,B,E,M,T;return[r("div",be,[r("fieldset",_e,[we,r("div",he,[a(_,{modelValue:s(t).full_name,"onUpdate:modelValue":e[1]||(e[1]=o=>s(t).full_name=o),error:!!((n=s(t).errors)!=null&&n.full_name),"error-message":(D=(v=s(t).errors)==null?void 0:v.full_name)==null?void 0:D.toString(),rules:[o=>!!o||"Full Name is required"],autocomplete:"off","bg-color":"white",label:"Name","no-error-icon":"",outlined:""},null,8,["modelValue","error","error-message","rules"])]),r("div",ke,[a(_,{modelValue:s(t).designation,"onUpdate:modelValue":e[2]||(e[2]=o=>s(t).designation=o),"bg-color":"white",label:"Designation","no-error-icon":"",outlined:"",rules:[o=>!0],autocomplete:"off"},null,8,["modelValue"])]),r("div",ye,[a(_,{modelValue:s(t).mobile,"onUpdate:modelValue":e[3]||(e[3]=o=>s(t).mobile=o),error:!!((q=s(t).errors)!=null&&q.mobile),"error-message":(U=(O=s(t).errors)==null?void 0:O.mobile)==null?void 0:U.toString(),rules:[o=>!!o||"Mobile is required"],mask:"##########","bg-color":"white",label:"Mobile","no-error-icon":"",outlined:"",autocomplete:"off"},null,8,["modelValue","error","error-message","rules"])]),r("div",Ve,[a(z,{modelValue:s(t).role,"onUpdate:modelValue":e[4]||(e[4]=o=>s(t).role=o),clearable:"",error:!!((F=s(t).errors)!=null&&F.role),"error-message":(N=(I=s(t).errors)==null?void 0:I.role)==null?void 0:N.toString(),options:b.roles,"bg-color":"white",label:"Role","no-error-icon":"",outlined:""},null,8,["modelValue","error","error-message","options"])]),r("div",xe,[a(z,{modelValue:s(t).offices,"onUpdate:modelValue":e[5]||(e[5]=o=>s(t).offices=o),error:!!((L=s(t).errors)!=null&&L.office_id),"error-message":(B=($=s(t).errors)==null?void 0:$.office_id)==null?void 0:B.toString(),options:w.value,rules:[o=>!!o||"Office is required"],"use-input":"","input-debounce":"0",onNewValue:R,onFilter:G,multiple:"","bg-color":"white",label:"Office","use-chips":"","no-error-icon":"",outlined:"",autocomplete:"off"},null,8,["modelValue","error","error-message","options","rules"])]),r("div",Se,[a(_,{modelValue:s(t).password,"onUpdate:modelValue":e[6]||(e[6]=o=>s(t).password=o),type:f.toggle,error:!!((E=s(t).errors)!=null&&E.password),"error-message":(T=(M=s(t).errors)==null?void 0:M.password)==null?void 0:T.toString(),"bg-color":"white",label:"Password","no-error-icon":"",outlined:"",autocomplete:"new-password"},{append:u(()=>[f.toggle==="password"?(m(),g(p,{key:0,onClick:V,flat:"",round:"",icon:"o_visibility_off"})):(m(),g(p,{key:1,onClick:V,flat:"",round:"",icon:"o_visibility"}))]),_:1},8,["modelValue","type","error","error-message"])]),r("div",Qe,[r("div",Ce,[a(p,{loading:f.submitting,class:"sized-btn",color:"primary",label:"Save",type:"submit"},null,8,["loading"]),a(p,{class:"sized-btn",color:"negative",label:"Cancel",outline:"",onClick:e[7]||(e[7]=o=>l.$inertia.replace(l.route("user.active")))})])])])]),r("div",De,[r("fieldset",qe,[Oe,a(de,{separator:""},{default:u(()=>[(m(!0),le(re,null,ae(b.data.devices,o=>(m(),g(ce,{key:o.id},{default:u(()=>[a(y,{avatar:""},{default:u(()=>[o.active?(m(),g(Y,{key:0,color:"positive",name:"fiber_manual_record"})):(m(),g(Y,{key:1,color:"grey-4",name:"fiber_manual_record"}))]),_:2},1024),a(y,null,{default:u(()=>[a(P,null,{default:u(()=>[j(A(o==null?void 0:o.name),1)]),_:2},1024),a(P,null,{default:u(()=>[j(A(o==null?void 0:o.code),1)]),_:2},1024)]),_:2},1024),a(y,{side:""},{default:u(()=>[a(ie,{"onUpdate:modelValue":[h=>J(o),h=>o.active=h],modelValue:o.active,class:"text-white"},null,8,["onUpdate:modelValue","modelValue"])]),_:2},1024),a(p,{flat:"",round:"",icon:"delete",color:"negative",onClick:h=>Z(o)},null,8,["onClick"])]),_:2},1024))),128))]),_:1})])])]}),_:1})]}),_:1}))}});export{je as default};
